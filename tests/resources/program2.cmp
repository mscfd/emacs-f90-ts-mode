(:indentation
"program prog2

 implicit none

 type, abstract :: base_t
      integer :: ival = 123
 end type base_t

 type, extends(base_t) :: extra_t
      integer :: jval = 456
 end type extra_t

 class(base_t), pointer :: p

 allocate(extra_t :: p)
 select type (p)
 class is (extra_t)
      call p%set(i=456, &
                 j=123)
      print *, p%ival
      call p%unset()
 class default
      print *, 'unknown type'
 end select

contains

 subroutine set(obj, i, j)
      class(extra_t), intent(out) :: obj
      integer, intent(in) :: i,&
                             j
      obj%ival = i
      obj%jval = j
 end subroutine set

 subroutine unset(obj)
      class(extra_t), intent(inout) :: obj
      call obj%set(i=123, &
                   j=456)
 end subroutine unset

end program prog2
"

:font-lock
((1 1 8 font-lock-keyword-face) (1 9 14 font-lock-function-name-face) (3 17 25 font-lock-keyword-face) (5 33 37 font-lock-keyword-face) (5 37 38 f90-ts-font-lock-delimiter-face) (5 39 47 font-lock-keyword-face) (5 48 50 f90-ts-font-lock-delimiter-face) (5 51 57 font-lock-type-face) (6 64 71 font-lock-type-face) (6 72 74 f90-ts-font-lock-delimiter-face) (6 80 81 f90-ts-font-lock-operator-face) (6 82 85 font-lock-number-face) (7 87 90 font-lock-keyword-face) (7 91 95 font-lock-keyword-face) (7 96 102 font-lock-type-face) (9 105 109 font-lock-keyword-face) (9 109 110 f90-ts-font-lock-delimiter-face) (9 111 118 font-lock-keyword-face) (9 118 119 f90-ts-font-lock-bracket-face) (9 119 125 font-lock-type-face) (9 125 126 f90-ts-font-lock-bracket-face) (9 127 129 f90-ts-font-lock-delimiter-face) (9 130 137 font-lock-type-face) (10 144 151 font-lock-type-face) (10 152 154 f90-ts-font-lock-delimiter-face) (10 160 161 f90-ts-font-lock-operator-face) (10 162 165 font-lock-number-face) (11 167 170 font-lock-keyword-face) (11 171 175 font-lock-keyword-face) (11 176 183 font-lock-type-face) (13 186 191 font-lock-keyword-face) (13 191 192 f90-ts-font-lock-bracket-face) (13 192 198 font-lock-type-face) (13 198 199 f90-ts-font-lock-bracket-face) (13 199 200 f90-ts-font-lock-delimiter-face) (13 201 208 font-lock-keyword-face) (13 209 211 f90-ts-font-lock-delimiter-face) (15 216 224 font-lock-keyword-face) (15 224 225 f90-ts-font-lock-bracket-face) (15 225 232 font-lock-type-face) (15 233 235 f90-ts-font-lock-delimiter-face) (15 237 238 f90-ts-font-lock-bracket-face) (16 240 246 font-lock-keyword-face) (16 247 251 font-lock-keyword-face) (16 252 253 f90-ts-font-lock-bracket-face) (16 254 255 f90-ts-font-lock-bracket-face) (17 257 262 font-lock-keyword-face) (17 263 265 font-lock-keyword-face) (17 266 267 f90-ts-font-lock-bracket-face) (17 267 274 font-lock-type-face) (17 274 275 f90-ts-font-lock-bracket-face) (18 282 286 font-lock-keyword-face) (18 288 289 f90-ts-font-lock-operator-face) (18 292 293 f90-ts-font-lock-bracket-face) (18 294 295 f90-ts-font-lock-operator-face) (18 295 298 font-lock-number-face) (18 298 299 f90-ts-font-lock-delimiter-face) (18 300 301 f90-ts-font-lock-delimiter-face) (19 320 321 f90-ts-font-lock-operator-face) (19 321 324 font-lock-number-face) (19 324 325 f90-ts-font-lock-bracket-face) (20 332 337 font-lock-builtin-face) (20 339 340 f90-ts-font-lock-delimiter-face) (20 342 343 f90-ts-font-lock-operator-face) (21 354 358 font-lock-keyword-face) (21 360 361 f90-ts-font-lock-operator-face) (21 366 368 f90-ts-font-lock-bracket-face) (22 370 375 font-lock-keyword-face) (22 376 383 font-lock-keyword-face) (23 390 395 font-lock-builtin-face) (23 397 398 f90-ts-font-lock-delimiter-face) (23 399 413 font-lock-string-face) (24 415 418 font-lock-keyword-face) (24 419 425 font-lock-keyword-face) (26 427 435 font-lock-keyword-face) (28 438 448 font-lock-keyword-face) (28 449 452 font-lock-function-name-face) (28 452 453 f90-ts-font-lock-bracket-face) (28 456 457 f90-ts-font-lock-delimiter-face) (28 459 460 f90-ts-font-lock-delimiter-face) (28 462 463 f90-ts-font-lock-bracket-face) (29 470 475 font-lock-keyword-face) (29 475 476 f90-ts-font-lock-bracket-face) (29 476 483 font-lock-type-face) (29 483 484 f90-ts-font-lock-bracket-face) (29 484 485 f90-ts-font-lock-delimiter-face) (29 486 497 font-lock-keyword-face) (29 498 500 f90-ts-font-lock-delimiter-face) (30 511 518 font-lock-type-face) (30 518 519 f90-ts-font-lock-delimiter-face) (30 520 530 font-lock-keyword-face) (30 531 533 f90-ts-font-lock-delimiter-face) (30 535 537 f90-ts-font-lock-delimiter-face) (32 578 579 f90-ts-font-lock-operator-face) (32 584 585 f90-ts-font-lock-operator-face) (33 597 598 f90-ts-font-lock-operator-face) (33 603 604 f90-ts-font-lock-operator-face) (34 608 611 font-lock-keyword-face) (34 612 622 font-lock-keyword-face) (34 623 626 font-lock-function-name-face) (36 629 639 font-lock-keyword-face) (36 640 645 font-lock-function-name-face) (36 645 646 f90-ts-font-lock-bracket-face) (36 649 650 f90-ts-font-lock-bracket-face) (37 657 662 font-lock-keyword-face) (37 662 663 f90-ts-font-lock-bracket-face) (37 663 670 font-lock-type-face) (37 670 671 f90-ts-font-lock-bracket-face) (37 671 672 f90-ts-font-lock-delimiter-face) (37 673 686 font-lock-keyword-face) (37 687 689 f90-ts-font-lock-delimiter-face) (38 700 704 font-lock-keyword-face) (38 708 709 f90-ts-font-lock-operator-face) (38 712 713 f90-ts-font-lock-bracket-face) (38 714 715 f90-ts-font-lock-operator-face) (38 715 718 font-lock-number-face) (38 718 719 f90-ts-font-lock-delimiter-face) (38 720 721 f90-ts-font-lock-delimiter-face) (39 742 743 f90-ts-font-lock-operator-face) (39 743 746 font-lock-number-face) (39 746 747 f90-ts-font-lock-bracket-face) (40 749 752 font-lock-keyword-face) (40 753 763 font-lock-keyword-face) (40 764 769 font-lock-function-name-face) (42 771 774 font-lock-keyword-face) (42 775 782 font-lock-keyword-face) (42 783 788 font-lock-function-name-face))

:tree
"(translation_unit (program (program_statement (name)) (implicit_statement (none)) (derived_type_definition (derived_type_statement (abstract_specifier) (type_name)) (variable_declaration type: (intrinsic_type) declarator: (init_declarator left: (identifier) right: (number_literal))) (end_type_statement (name))) (derived_type_definition (derived_type_statement base: (base_type_specifier (identifier)) (type_name)) (variable_declaration type: (intrinsic_type) declarator: (init_declarator left: (identifier) right: (number_literal))) (end_type_statement (name))) (variable_declaration type: (derived_type name: (type_name)) attribute: (type_qualifier) declarator: (identifier)) (allocate_statement type: (identifier) allocation: (identifier)) (select_type_statement (selector (identifier)) (type_statement type: (identifier) (subroutine_call subroutine: (derived_type_member_expression (identifier) (type_member)) (argument_list (keyword_argument name: (identifier) value: (number_literal)) (keyword_argument name: (identifier) value: (number_literal)))) (print_statement (format_identifier) (output_item_list (derived_type_member_expression (identifier) (type_member)))) (subroutine_call subroutine: (derived_type_member_expression (identifier) (type_member)) (argument_list))) (type_statement (default) (print_statement (format_identifier) (output_item_list (string_literal)))) (end_select_statement)) (internal_procedures (contains_statement) (subroutine (subroutine_statement name: (name) parameters: (parameters (identifier) (identifier) (identifier))) (variable_declaration type: (derived_type name: (type_name)) attribute: (type_qualifier) declarator: (identifier)) (variable_declaration type: (intrinsic_type) attribute: (type_qualifier) declarator: (identifier) declarator: (identifier)) (assignment_statement left: (derived_type_member_expression (identifier) (type_member)) right: (identifier)) (assignment_statement left: (derived_type_member_expression (identifier) (type_member)) right: (identifier)) (end_subroutine_statement (name))) (subroutine (subroutine_statement name: (name) parameters: (parameters (identifier))) (variable_declaration type: (derived_type name: (type_name)) attribute: (type_qualifier) declarator: (identifier)) (subroutine_call subroutine: (derived_type_member_expression (identifier) (type_member)) (argument_list (keyword_argument name: (identifier) value: (number_literal)) (keyword_argument name: (identifier) value: (number_literal)))) (end_subroutine_statement (name)))) (end_program_statement (name))))")
