(:indentation
"program prog2

 implicit none

 type, abstract :: base_t
 integer :: ival = 123
 end type base_t

 type, extends(base_t) :: extra_t
 integer :: jval = 456
 end type extra_t

 class(base_t), pointer :: p

 allocate(extra_t :: p)
 select type (p)
 class is (extra_t)
      call p%set(i=456, &
                 j=123)
      print *, p%ival
      call p%unset()
 class default
      print *, 'unknown type'
 end select

contains

 subroutine set(obj, i, j)
      class(extra_t), intent(out) :: obj
      integer, intent(in) :: i,&
                             j
      obj%ival = i
      obj%jval = j
 end subroutine set

 subroutine unset(obj)
      class(extra_t), intent(inout) :: obj
      call obj%set(i=123, &
                   j=456)
 end subroutine unset

end program prog2
"

:font-lock
((1 1 8 font-lock-keyword-face) (1 9 14 font-lock-function-name-face) (3 17 25 font-lock-keyword-face) (5 33 37 font-lock-keyword-face) (5 37 38 f90-ts-font-lock-delimiter-face) (5 39 47 font-lock-keyword-face) (5 48 50 f90-ts-font-lock-delimiter-face) (5 51 57 font-lock-type-face) (6 59 66 font-lock-type-face) (6 67 69 f90-ts-font-lock-delimiter-face) (6 75 76 f90-ts-font-lock-operator-face) (6 77 80 font-lock-number-face) (7 82 85 font-lock-keyword-face) (7 86 90 font-lock-keyword-face) (7 91 97 font-lock-type-face) (9 100 104 font-lock-keyword-face) (9 104 105 f90-ts-font-lock-delimiter-face) (9 106 113 font-lock-keyword-face) (9 113 114 f90-ts-font-lock-bracket-face) (9 114 120 font-lock-type-face) (9 120 121 f90-ts-font-lock-bracket-face) (9 122 124 f90-ts-font-lock-delimiter-face) (9 125 132 font-lock-type-face) (10 134 141 font-lock-type-face) (10 142 144 f90-ts-font-lock-delimiter-face) (10 150 151 f90-ts-font-lock-operator-face) (10 152 155 font-lock-number-face) (11 157 160 font-lock-keyword-face) (11 161 165 font-lock-keyword-face) (11 166 173 font-lock-type-face) (13 176 181 font-lock-keyword-face) (13 181 182 f90-ts-font-lock-bracket-face) (13 182 188 font-lock-type-face) (13 188 189 f90-ts-font-lock-bracket-face) (13 189 190 f90-ts-font-lock-delimiter-face) (13 191 198 font-lock-keyword-face) (13 199 201 f90-ts-font-lock-delimiter-face) (15 206 214 font-lock-keyword-face) (15 214 215 f90-ts-font-lock-bracket-face) (15 215 222 font-lock-type-face) (15 223 225 f90-ts-font-lock-delimiter-face) (15 227 228 f90-ts-font-lock-bracket-face) (16 230 236 font-lock-keyword-face) (16 237 241 font-lock-keyword-face) (16 242 243 f90-ts-font-lock-bracket-face) (16 244 245 f90-ts-font-lock-bracket-face) (17 247 252 font-lock-keyword-face) (17 253 255 font-lock-keyword-face) (17 256 257 f90-ts-font-lock-bracket-face) (17 257 264 font-lock-type-face) (17 264 265 f90-ts-font-lock-bracket-face) (18 272 276 font-lock-keyword-face) (18 278 279 f90-ts-font-lock-operator-face) (18 282 283 f90-ts-font-lock-bracket-face) (18 284 285 f90-ts-font-lock-operator-face) (18 285 288 font-lock-number-face) (18 288 289 f90-ts-font-lock-delimiter-face) (18 290 291 f90-ts-font-lock-delimiter-face) (19 310 311 f90-ts-font-lock-operator-face) (19 311 314 font-lock-number-face) (19 314 315 f90-ts-font-lock-bracket-face) (20 322 327 f90-ts-font-lock-intrinsic-face) (20 329 330 f90-ts-font-lock-delimiter-face) (20 332 333 f90-ts-font-lock-operator-face) (21 344 348 font-lock-keyword-face) (21 350 351 f90-ts-font-lock-operator-face) (21 356 358 f90-ts-font-lock-bracket-face) (22 360 365 font-lock-keyword-face) (22 366 373 font-lock-keyword-face) (23 380 385 f90-ts-font-lock-intrinsic-face) (23 387 388 f90-ts-font-lock-delimiter-face) (23 389 403 font-lock-string-face) (24 405 408 font-lock-keyword-face) (24 409 415 font-lock-keyword-face) (26 417 425 font-lock-keyword-face) (28 428 438 font-lock-keyword-face) (28 439 442 font-lock-function-name-face) (28 442 443 f90-ts-font-lock-bracket-face) (28 446 447 f90-ts-font-lock-delimiter-face) (28 449 450 f90-ts-font-lock-delimiter-face) (28 452 453 f90-ts-font-lock-bracket-face) (29 460 465 font-lock-keyword-face) (29 465 466 f90-ts-font-lock-bracket-face) (29 466 473 font-lock-type-face) (29 473 474 f90-ts-font-lock-bracket-face) (29 474 475 f90-ts-font-lock-delimiter-face) (29 476 487 font-lock-keyword-face) (29 488 490 f90-ts-font-lock-delimiter-face) (30 501 508 font-lock-type-face) (30 508 509 f90-ts-font-lock-delimiter-face) (30 510 520 font-lock-keyword-face) (30 521 523 f90-ts-font-lock-delimiter-face) (30 525 527 f90-ts-font-lock-delimiter-face) (32 568 569 f90-ts-font-lock-operator-face) (32 574 575 f90-ts-font-lock-operator-face) (33 587 588 f90-ts-font-lock-operator-face) (33 593 594 f90-ts-font-lock-operator-face) (34 598 601 font-lock-keyword-face) (34 602 612 font-lock-keyword-face) (34 613 616 font-lock-function-name-face) (36 619 629 font-lock-keyword-face) (36 630 635 font-lock-function-name-face) (36 635 636 f90-ts-font-lock-bracket-face) (36 639 640 f90-ts-font-lock-bracket-face) (37 647 652 font-lock-keyword-face) (37 652 653 f90-ts-font-lock-bracket-face) (37 653 660 font-lock-type-face) (37 660 661 f90-ts-font-lock-bracket-face) (37 661 662 f90-ts-font-lock-delimiter-face) (37 663 676 font-lock-keyword-face) (37 677 679 f90-ts-font-lock-delimiter-face) (38 690 694 font-lock-keyword-face) (38 698 699 f90-ts-font-lock-operator-face) (38 702 703 f90-ts-font-lock-bracket-face) (38 704 705 f90-ts-font-lock-operator-face) (38 705 708 font-lock-number-face) (38 708 709 f90-ts-font-lock-delimiter-face) (38 710 711 f90-ts-font-lock-delimiter-face) (39 732 733 f90-ts-font-lock-operator-face) (39 733 736 font-lock-number-face) (39 736 737 f90-ts-font-lock-bracket-face) (40 739 742 font-lock-keyword-face) (40 743 753 font-lock-keyword-face) (40 754 759 font-lock-function-name-face) (42 761 764 font-lock-keyword-face) (42 765 772 font-lock-keyword-face) (42 773 778 font-lock-function-name-face))

:tree
"(translation_unit (program (program_statement (name)) (implicit_statement (none)) (derived_type_definition (derived_type_statement (abstract_specifier) (type_name)) (variable_declaration type: (intrinsic_type) declarator: (init_declarator left: (identifier) right: (number_literal))) (end_type_statement (name))) (derived_type_definition (derived_type_statement base: (base_type_specifier (identifier)) (type_name)) (variable_declaration type: (intrinsic_type) declarator: (init_declarator left: (identifier) right: (number_literal))) (end_type_statement (name))) (variable_declaration type: (derived_type name: (type_name)) attribute: (type_qualifier) declarator: (identifier)) (allocate_statement type: (identifier) allocation: (identifier)) (select_type_statement (selector (identifier)) (type_statement type: (identifier) (subroutine_call subroutine: (derived_type_member_expression (identifier) (type_member)) (argument_list (keyword_argument name: (identifier) value: (number_literal)) (keyword_argument name: (identifier) value: (number_literal)))) (print_statement (format_identifier) (output_item_list (derived_type_member_expression (identifier) (type_member)))) (subroutine_call subroutine: (derived_type_member_expression (identifier) (type_member)) (argument_list))) (type_statement (default) (print_statement (format_identifier) (output_item_list (string_literal)))) (end_select_statement)) (internal_procedures (contains_statement) (subroutine (subroutine_statement name: (name) parameters: (parameters (identifier) (identifier) (identifier))) (variable_declaration type: (derived_type name: (type_name)) attribute: (type_qualifier) declarator: (identifier)) (variable_declaration type: (intrinsic_type) attribute: (type_qualifier) declarator: (identifier) declarator: (identifier)) (assignment_statement left: (derived_type_member_expression (identifier) (type_member)) right: (identifier)) (assignment_statement left: (derived_type_member_expression (identifier) (type_member)) right: (identifier)) (end_subroutine_statement (name))) (subroutine (subroutine_statement name: (name) parameters: (parameters (identifier))) (variable_declaration type: (derived_type name: (type_name)) attribute: (type_qualifier) declarator: (identifier)) (subroutine_call subroutine: (derived_type_member_expression (identifier) (type_member)) (argument_list (keyword_argument name: (identifier) value: (number_literal)) (keyword_argument name: (identifier) value: (number_literal)))) (end_subroutine_statement (name)))) (end_program_statement (name))))")
