(:indentation
"program program1

 use, intrinsic :: iso_fortran_env

 abstract interface
      real(real32) function f_ifc(x)
           import real32
           real(real32), intent(in) :: x
      end function f_ifc
 end interface

 real(real32) :: s
 integer, parameter :: N1 = 1, &
                       N2 = 100

 s = compute_sequence_sum(reciprocal, N1, N2)
 call print_result(s)

contains

 function compute_sequence_sum(fun, N1, N2) result(s_fun)
 ! result
      real(real32) :: s_fun
 ! arguments
      procedure(f_ifc) :: fun
      integer, intent(in) :: N1, N2
 ! ==========
      s_fun = 0.0
      do i = N1, N2
           block
                real(real32) :: r
                r = real(i, real32)
                s_fun = s_fun + fun(r)
           end block
      end do
 end function compute_sequence_sum

 real(real32) function reciprocal(x)
 ! arguments
      real(real32), intent(in) :: x
 ! ==========
      reciprocal = 1.0_real32 / x
 end function reciprocal

 subroutine print_result(s)
      real(real32), intent(in) :: s
      print '(a,f15.5)', 'result: ', s
 end subroutine print_result

end program program1
"

:font-lock
((1 1 8 font-lock-keyword-face) (1 9 17 font-lock-function-name-face) (3 20 23 font-lock-keyword-face) (3 23 24 f90-ts-font-lock-delimiter-face) (3 35 37 f90-ts-font-lock-delimiter-face) (5 56 64 font-lock-keyword-face) (5 65 74 font-lock-keyword-face) (6 81 85 font-lock-type-face) (6 85 86 f90-ts-font-lock-bracket-face) (6 92 93 f90-ts-font-lock-bracket-face) (6 94 102 font-lock-keyword-face) (6 103 108 font-lock-function-name-face) (6 108 109 f90-ts-font-lock-bracket-face) (6 110 111 f90-ts-font-lock-bracket-face) (8 148 152 font-lock-type-face) (8 152 153 f90-ts-font-lock-bracket-face) (8 159 160 f90-ts-font-lock-bracket-face) (8 160 161 f90-ts-font-lock-delimiter-face) (8 162 172 font-lock-keyword-face) (8 173 175 f90-ts-font-lock-delimiter-face) (9 184 187 font-lock-keyword-face) (9 188 196 font-lock-keyword-face) (9 197 202 font-lock-function-name-face) (10 204 207 font-lock-keyword-face) (10 208 217 font-lock-keyword-face) (12 220 224 font-lock-type-face) (12 224 225 f90-ts-font-lock-bracket-face) (12 231 232 f90-ts-font-lock-bracket-face) (12 233 235 f90-ts-font-lock-delimiter-face) (13 239 246 font-lock-type-face) (13 246 247 f90-ts-font-lock-delimiter-face) (13 248 257 font-lock-keyword-face) (13 258 260 f90-ts-font-lock-delimiter-face) (13 264 265 f90-ts-font-lock-operator-face) (13 266 267 font-lock-number-face) (13 267 268 f90-ts-font-lock-delimiter-face) (13 269 270 f90-ts-font-lock-delimiter-face) (14 297 298 f90-ts-font-lock-operator-face) (14 299 302 font-lock-number-face) (16 307 308 f90-ts-font-lock-operator-face) (16 309 329 font-lock-builtin-face) (16 329 330 f90-ts-font-lock-bracket-face) (16 340 341 f90-ts-font-lock-delimiter-face) (16 344 345 f90-ts-font-lock-delimiter-face) (16 348 349 f90-ts-font-lock-bracket-face) (17 351 355 font-lock-keyword-face) (17 356 368 font-lock-function-name-face) (17 368 369 f90-ts-font-lock-bracket-face) (17 370 371 f90-ts-font-lock-bracket-face) (19 373 381 font-lock-keyword-face) (21 384 392 font-lock-keyword-face) (21 393 413 font-lock-function-name-face) (21 413 414 f90-ts-font-lock-bracket-face) (21 417 418 f90-ts-font-lock-delimiter-face) (21 421 422 f90-ts-font-lock-delimiter-face) (21 425 426 f90-ts-font-lock-bracket-face) (21 427 433 font-lock-keyword-face) (21 433 434 f90-ts-font-lock-bracket-face) (21 434 439 default) (21 439 440 f90-ts-font-lock-bracket-face) (22 442 450 f90-ts-font-lock-special-comment-face) (23 457 461 font-lock-type-face) (23 461 462 f90-ts-font-lock-bracket-face) (23 468 469 f90-ts-font-lock-bracket-face) (23 470 472 f90-ts-font-lock-delimiter-face) (24 480 491 f90-ts-font-lock-special-comment-face) (25 498 507 font-lock-keyword-face) (25 507 508 f90-ts-font-lock-bracket-face) (25 508 513 font-lock-function-name-face) (25 513 514 f90-ts-font-lock-bracket-face) (25 515 517 f90-ts-font-lock-delimiter-face) (25 518 521 font-lock-function-name-face) (26 528 535 font-lock-type-face) (26 535 536 f90-ts-font-lock-delimiter-face) (26 537 547 font-lock-keyword-face) (26 548 550 f90-ts-font-lock-delimiter-face) (26 553 554 f90-ts-font-lock-delimiter-face) (27 559 571 f90-ts-font-lock-special-comment-face) (28 584 585 f90-ts-font-lock-operator-face) (28 586 589 font-lock-number-face) (29 596 598 font-lock-keyword-face) (29 601 602 f90-ts-font-lock-operator-face) (29 605 606 f90-ts-font-lock-delimiter-face) (30 621 626 font-lock-keyword-face) (31 643 647 font-lock-type-face) (31 647 648 f90-ts-font-lock-bracket-face) (31 654 655 f90-ts-font-lock-bracket-face) (31 656 658 f90-ts-font-lock-delimiter-face) (32 679 680 f90-ts-font-lock-operator-face) (32 681 685 font-lock-builtin-face) (32 685 686 f90-ts-font-lock-bracket-face) (32 687 688 f90-ts-font-lock-delimiter-face) (32 695 696 f90-ts-font-lock-bracket-face) (33 719 720 f90-ts-font-lock-operator-face) (33 727 728 f90-ts-font-lock-operator-face) (33 732 733 f90-ts-font-lock-bracket-face) (33 734 735 f90-ts-font-lock-bracket-face) (34 747 750 font-lock-keyword-face) (34 751 756 font-lock-keyword-face) (35 763 766 font-lock-keyword-face) (35 767 769 font-lock-keyword-face) (36 771 774 font-lock-keyword-face) (36 775 783 font-lock-keyword-face) (36 784 804 font-lock-function-name-face) (38 807 811 font-lock-type-face) (38 811 812 f90-ts-font-lock-bracket-face) (38 818 819 f90-ts-font-lock-bracket-face) (38 820 828 font-lock-keyword-face) (38 829 839 font-lock-function-name-face) (38 839 840 f90-ts-font-lock-bracket-face) (38 841 842 f90-ts-font-lock-bracket-face) (39 844 855 f90-ts-font-lock-special-comment-face) (40 862 866 font-lock-type-face) (40 866 867 f90-ts-font-lock-bracket-face) (40 873 874 f90-ts-font-lock-bracket-face) (40 874 875 f90-ts-font-lock-delimiter-face) (40 876 886 font-lock-keyword-face) (40 887 889 f90-ts-font-lock-delimiter-face) (41 893 905 f90-ts-font-lock-special-comment-face) (42 923 924 f90-ts-font-lock-operator-face) (42 925 935 font-lock-number-face) (42 936 937 f90-ts-font-lock-operator-face) (43 941 944 font-lock-keyword-face) (43 945 953 font-lock-keyword-face) (43 954 964 font-lock-function-name-face) (45 967 977 font-lock-keyword-face) (45 978 990 font-lock-function-name-face) (45 990 991 f90-ts-font-lock-bracket-face) (45 992 993 f90-ts-font-lock-bracket-face) (46 1000 1004 font-lock-type-face) (46 1004 1005 f90-ts-font-lock-bracket-face) (46 1011 1012 f90-ts-font-lock-bracket-face) (46 1012 1013 f90-ts-font-lock-delimiter-face) (46 1014 1024 font-lock-keyword-face) (46 1025 1027 f90-ts-font-lock-delimiter-face) (47 1036 1041 f90-ts-font-lock-intrinsic-face) (47 1042 1053 font-lock-string-face) (47 1053 1054 f90-ts-font-lock-delimiter-face) (47 1055 1065 font-lock-string-face) (47 1065 1066 f90-ts-font-lock-delimiter-face) (48 1070 1073 font-lock-keyword-face) (48 1074 1084 font-lock-keyword-face) (48 1085 1097 font-lock-function-name-face) (50 1099 1102 font-lock-keyword-face) (50 1103 1110 font-lock-keyword-face) (50 1111 1119 font-lock-function-name-face))

:tree
"(translation_unit (program (program_statement (name)) (use_statement (module_name)) (interface (interface_statement (abstract_specifier)) (function (function_statement type: (intrinsic_type kind: (kind (identifier))) name: (name) parameters: (parameters (identifier))) (import_statement (identifier)) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) attribute: (type_qualifier) declarator: (identifier)) (end_function_statement (name))) (end_interface_statement)) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) declarator: (identifier)) (variable_declaration type: (intrinsic_type) attribute: (type_qualifier) declarator: (init_declarator left: (identifier) right: (number_literal)) declarator: (init_declarator left: (identifier) right: (number_literal))) (assignment_statement left: (identifier) right: (call_expression (identifier) (argument_list (identifier) (identifier) (identifier)))) (subroutine_call subroutine: (identifier) (argument_list (identifier))) (internal_procedures (contains_statement) (function (function_statement name: (name) parameters: (parameters (identifier) (identifier) (identifier)) (function_result (identifier))) (comment) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) declarator: (identifier)) (comment) (variable_declaration type: (procedure (procedure_interface)) declarator: (identifier)) (variable_declaration type: (intrinsic_type) attribute: (type_qualifier) declarator: (identifier) declarator: (identifier)) (comment) (assignment_statement left: (identifier) right: (number_literal)) (do_loop (do_statement (loop_control_expression (identifier) (identifier) (identifier))) (block_construct (variable_declaration type: (intrinsic_type kind: (kind (identifier))) declarator: (identifier)) (assignment_statement left: (identifier) right: (call_expression (identifier) (argument_list (identifier) (identifier)))) (assignment_statement left: (identifier) right: (math_expression left: (identifier) right: (call_expression (identifier) (argument_list (identifier))))) (end_block_construct_statement)) (end_do_loop_statement)) (end_function_statement (name))) (function (function_statement type: (intrinsic_type kind: (kind (identifier))) name: (name) parameters: (parameters (identifier))) (comment) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) attribute: (type_qualifier) declarator: (identifier)) (comment) (assignment_statement left: (identifier) right: (math_expression left: (number_literal kind: (identifier)) right: (identifier))) (end_function_statement (name))) (subroutine (subroutine_statement name: (name) parameters: (parameters (identifier))) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) attribute: (type_qualifier) declarator: (identifier)) (print_statement (format_identifier (string_literal)) (output_item_list (string_literal) (identifier))) (end_subroutine_statement (name)))) (end_program_statement (name))))")
