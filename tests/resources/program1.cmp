(:indentation
"program program1

 use, intrinsic :: iso_fortran_env

 abstract interface
 real(real32) function f_ifc(x)
      import real32
      real(real32), intent(in) :: x
 end function f_ifc
 end interface

 real(real32) :: s
 integer, parameter :: N1 = 1, &
 N2 = 100

 s = compute_sequence_sum(reciprocal, N1, N2)
 call print_result(s)

contains

 function compute_sequence_sum(fun, N1, N2) result(s_fun)
 ! result
      real(real32) :: s_fun
 ! arguments
      procedure(f_ifc) :: fun
      integer, intent(in) :: N1, N2
 ! ==========
      s_fun = 0.0
      do i = N1, N2
           block
                real(real32) :: r
                r = real(i, real32)
                s_fun = s_fun + fun(r)
           end block
      end do
 end function compute_sequence_sum

 real(real32) function reciprocal(x)
 ! arguments
      real(real32), intent(in) :: x
 ! ==========
      reciprocal = 1.0_real32 / x
 end function reciprocal

 subroutine print_result(s)
      real(real32), intent(in) :: s
      print '(a,f15.5)', 'result: ', s
 end subroutine print_result

end program program1
"

:font-lock
((1 1 8 font-lock-keyword-face) (1 9 17 font-lock-function-name-face) (3 20 23 font-lock-keyword-face) (3 23 24 f90-ts-font-lock-delimiter-face) (3 35 37 f90-ts-font-lock-delimiter-face) (5 56 64 font-lock-keyword-face) (5 65 74 font-lock-keyword-face) (6 76 80 font-lock-type-face) (6 80 81 f90-ts-font-lock-bracket-face) (6 87 88 f90-ts-font-lock-bracket-face) (6 89 97 font-lock-keyword-face) (6 98 103 font-lock-function-name-face) (6 103 104 f90-ts-font-lock-bracket-face) (6 105 106 f90-ts-font-lock-bracket-face) (8 133 137 font-lock-type-face) (8 137 138 f90-ts-font-lock-bracket-face) (8 144 145 f90-ts-font-lock-bracket-face) (8 145 146 f90-ts-font-lock-delimiter-face) (8 147 157 font-lock-keyword-face) (8 158 160 f90-ts-font-lock-delimiter-face) (9 164 167 font-lock-keyword-face) (9 168 176 font-lock-keyword-face) (9 177 182 font-lock-function-name-face) (10 184 187 font-lock-keyword-face) (10 188 197 font-lock-keyword-face) (12 200 204 font-lock-type-face) (12 204 205 f90-ts-font-lock-bracket-face) (12 211 212 f90-ts-font-lock-bracket-face) (12 213 215 f90-ts-font-lock-delimiter-face) (13 219 226 font-lock-type-face) (13 226 227 f90-ts-font-lock-delimiter-face) (13 228 237 font-lock-keyword-face) (13 238 240 f90-ts-font-lock-delimiter-face) (13 244 245 f90-ts-font-lock-operator-face) (13 246 247 font-lock-number-face) (13 247 248 f90-ts-font-lock-delimiter-face) (13 249 250 f90-ts-font-lock-delimiter-face) (14 255 256 f90-ts-font-lock-operator-face) (14 257 260 font-lock-number-face) (16 265 266 f90-ts-font-lock-operator-face) (16 267 287 font-lock-builtin-face) (16 287 288 f90-ts-font-lock-bracket-face) (16 298 299 f90-ts-font-lock-delimiter-face) (16 302 303 f90-ts-font-lock-delimiter-face) (16 306 307 f90-ts-font-lock-bracket-face) (17 309 313 font-lock-keyword-face) (17 314 326 font-lock-function-name-face) (17 326 327 f90-ts-font-lock-bracket-face) (17 328 329 f90-ts-font-lock-bracket-face) (19 331 339 font-lock-keyword-face) (21 342 350 font-lock-keyword-face) (21 351 371 font-lock-function-name-face) (21 371 372 f90-ts-font-lock-bracket-face) (21 375 376 f90-ts-font-lock-delimiter-face) (21 379 380 f90-ts-font-lock-delimiter-face) (21 383 384 f90-ts-font-lock-bracket-face) (21 385 391 font-lock-keyword-face) (21 391 392 f90-ts-font-lock-bracket-face) (21 392 397 default) (21 397 398 f90-ts-font-lock-bracket-face) (22 400 408 f90-ts-font-lock-special-comment-face) (23 415 419 font-lock-type-face) (23 419 420 f90-ts-font-lock-bracket-face) (23 426 427 f90-ts-font-lock-bracket-face) (23 428 430 f90-ts-font-lock-delimiter-face) (24 438 449 f90-ts-font-lock-special-comment-face) (25 456 465 font-lock-keyword-face) (25 465 466 f90-ts-font-lock-bracket-face) (25 466 471 font-lock-function-name-face) (25 471 472 f90-ts-font-lock-bracket-face) (25 473 475 f90-ts-font-lock-delimiter-face) (25 476 479 font-lock-function-name-face) (26 486 493 font-lock-type-face) (26 493 494 f90-ts-font-lock-delimiter-face) (26 495 505 font-lock-keyword-face) (26 506 508 f90-ts-font-lock-delimiter-face) (26 511 512 f90-ts-font-lock-delimiter-face) (27 517 529 f90-ts-font-lock-special-comment-face) (28 542 543 f90-ts-font-lock-operator-face) (28 544 547 font-lock-number-face) (29 554 556 font-lock-keyword-face) (29 559 560 f90-ts-font-lock-operator-face) (29 563 564 f90-ts-font-lock-delimiter-face) (30 579 584 font-lock-keyword-face) (31 601 605 font-lock-type-face) (31 605 606 f90-ts-font-lock-bracket-face) (31 612 613 f90-ts-font-lock-bracket-face) (31 614 616 f90-ts-font-lock-delimiter-face) (32 637 638 f90-ts-font-lock-operator-face) (32 639 643 font-lock-builtin-face) (32 643 644 f90-ts-font-lock-bracket-face) (32 645 646 f90-ts-font-lock-delimiter-face) (32 653 654 f90-ts-font-lock-bracket-face) (33 677 678 f90-ts-font-lock-operator-face) (33 685 686 f90-ts-font-lock-operator-face) (33 690 691 f90-ts-font-lock-bracket-face) (33 692 693 f90-ts-font-lock-bracket-face) (34 705 708 font-lock-keyword-face) (34 709 714 font-lock-keyword-face) (35 721 724 font-lock-keyword-face) (35 725 727 font-lock-keyword-face) (36 729 732 font-lock-keyword-face) (36 733 741 font-lock-keyword-face) (36 742 762 font-lock-function-name-face) (38 765 769 font-lock-type-face) (38 769 770 f90-ts-font-lock-bracket-face) (38 776 777 f90-ts-font-lock-bracket-face) (38 778 786 font-lock-keyword-face) (38 787 797 font-lock-function-name-face) (38 797 798 f90-ts-font-lock-bracket-face) (38 799 800 f90-ts-font-lock-bracket-face) (39 802 813 f90-ts-font-lock-special-comment-face) (40 820 824 font-lock-type-face) (40 824 825 f90-ts-font-lock-bracket-face) (40 831 832 f90-ts-font-lock-bracket-face) (40 832 833 f90-ts-font-lock-delimiter-face) (40 834 844 font-lock-keyword-face) (40 845 847 f90-ts-font-lock-delimiter-face) (41 851 863 f90-ts-font-lock-special-comment-face) (42 881 882 f90-ts-font-lock-operator-face) (42 883 893 font-lock-number-face) (42 894 895 f90-ts-font-lock-operator-face) (43 899 902 font-lock-keyword-face) (43 903 911 font-lock-keyword-face) (43 912 922 font-lock-function-name-face) (45 925 935 font-lock-keyword-face) (45 936 948 font-lock-function-name-face) (45 948 949 f90-ts-font-lock-bracket-face) (45 950 951 f90-ts-font-lock-bracket-face) (46 958 962 font-lock-type-face) (46 962 963 f90-ts-font-lock-bracket-face) (46 969 970 f90-ts-font-lock-bracket-face) (46 970 971 f90-ts-font-lock-delimiter-face) (46 972 982 font-lock-keyword-face) (46 983 985 f90-ts-font-lock-delimiter-face) (47 994 999 f90-ts-font-lock-intrinsic-face) (47 1000 1011 font-lock-string-face) (47 1011 1012 f90-ts-font-lock-delimiter-face) (47 1013 1023 font-lock-string-face) (47 1023 1024 f90-ts-font-lock-delimiter-face) (48 1028 1031 font-lock-keyword-face) (48 1032 1042 font-lock-keyword-face) (48 1043 1055 font-lock-function-name-face) (50 1057 1060 font-lock-keyword-face) (50 1061 1068 font-lock-keyword-face) (50 1069 1077 font-lock-function-name-face))

:tree
"(translation_unit (program (program_statement (name)) (use_statement (module_name)) (interface (interface_statement (abstract_specifier)) (function (function_statement type: (intrinsic_type kind: (kind (identifier))) name: (name) parameters: (parameters (identifier))) (import_statement (identifier)) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) attribute: (type_qualifier) declarator: (identifier)) (end_function_statement (name))) (end_interface_statement)) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) declarator: (identifier)) (variable_declaration type: (intrinsic_type) attribute: (type_qualifier) declarator: (init_declarator left: (identifier) right: (number_literal)) declarator: (init_declarator left: (identifier) right: (number_literal))) (assignment_statement left: (identifier) right: (call_expression (identifier) (argument_list (identifier) (identifier) (identifier)))) (subroutine_call subroutine: (identifier) (argument_list (identifier))) (internal_procedures (contains_statement) (function (function_statement name: (name) parameters: (parameters (identifier) (identifier) (identifier)) (function_result (identifier))) (comment) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) declarator: (identifier)) (comment) (variable_declaration type: (procedure (procedure_interface)) declarator: (identifier)) (variable_declaration type: (intrinsic_type) attribute: (type_qualifier) declarator: (identifier) declarator: (identifier)) (comment) (assignment_statement left: (identifier) right: (number_literal)) (do_loop (do_statement (loop_control_expression (identifier) (identifier) (identifier))) (block_construct (variable_declaration type: (intrinsic_type kind: (kind (identifier))) declarator: (identifier)) (assignment_statement left: (identifier) right: (call_expression (identifier) (argument_list (identifier) (identifier)))) (assignment_statement left: (identifier) right: (math_expression left: (identifier) right: (call_expression (identifier) (argument_list (identifier))))) (end_block_construct_statement)) (end_do_loop_statement)) (end_function_statement (name))) (function (function_statement type: (intrinsic_type kind: (kind (identifier))) name: (name) parameters: (parameters (identifier))) (comment) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) attribute: (type_qualifier) declarator: (identifier)) (comment) (assignment_statement left: (identifier) right: (math_expression left: (number_literal kind: (identifier)) right: (identifier))) (end_function_statement (name))) (subroutine (subroutine_statement name: (name) parameters: (parameters (identifier))) (variable_declaration type: (intrinsic_type kind: (kind (identifier))) attribute: (type_qualifier) declarator: (identifier)) (print_statement (format_identifier (string_literal)) (output_item_list (string_literal) (identifier))) (end_subroutine_statement (name)))) (end_program_statement (name))))")
